# agenda-pimpinan/.htaccess

# Disable directory listing
Options -Indexes

# Prevent access to sensitive files
<FilesMatch "\.(env|ini|log|sql|json|lock)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Prevent access to hidden files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Security headers
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "SAMEORIGIN"
Header set X-XSS-Protection "1; mode=block"

# URL Rewriting
RewriteEngine On

# Redirect to HTTPS if not localhost
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} !localhost
RewriteCond %{HTTP_HOST} !127.0.0.1
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]

# Protect sensitive directories
RewriteRule ^(config|models|controllers|helpers|middlewares|database)/ - [F,L]

# Pretty URLs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?route=$1 [QSA,L]